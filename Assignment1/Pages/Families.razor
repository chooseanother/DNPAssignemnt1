@page "/families"
@using Assignment1.Data
@using Models
@inject IFamilyDataService FamilyData
@inject NavigationManager NavManager

<h1>Families</h1>
@* <p>Filter by Street Name: <InputTextArea rows="4" @oninput="(arg) => FilterByStreetName(arg)" /></p> *@


@if (familiesToShow == null)
{
    <p>
        <em>Loading...</em>
    </p>
}
else if (!familiesToShow.Any())
{
    <p>
        <em>No Family items exist. Please add some.</em>
    </p>
}
else
{
    <table class="table">
        <thead>
        <tr>
            <th>Street Name</th>
            <th>House Number</th>
            <th>Adults</th>
            <th>Children</th>
            <th>Pets</th>
            <th>Details</th>
            <th>Edit</th>
            <th>Delete</th>
        </tr>
        </thead>
        <tbody>
        @foreach (var item in familiesToShow)
        {
            <tr>
                <td>@item.StreetName</td>
                <td>@item.HouseNumber</td>
                <td>@item.Adults.Count()</td>
                <td>@item.Children.Count()</td>
                <td>@item.Pets.Count()</td>
                <td>
                    <button @onclick='() => Show(item.StreetName,item.HouseNumber)'>
                        <i class="oi oi-trash" style="color:red;"></i>
                    </button>
                </td>
                <td>
                    @* <button @onclick='() => RemoveTodo(item.TodoId)'> *@
                    <button>
                        <i class="oi oi-trash" style="color:red;"></i>
                    </button>
                </td>
                <td>
                @* <button @onclick='() => Edit(item.TodoId)'> *@
                    <button>
                        <i class="oi oi-pencil" style="color:#1b6ec2;"></i>
                    </button>
                </td>
            </tr>
        }
        </tbody>
    </table>
}

@code {
    private IList<Family> familiesToShow;
    private IList<Family> allFamilies;

    private string? filterByStreetName;

    protected override async Task OnInitializedAsync()
    {
        allFamilies = FamilyData.GetFamilies();
        familiesToShow = allFamilies;
    }

    private void Show(string streetName, int houseNumber)
    {
        NavManager.NavigateTo($"show/{streetName}/{houseNumber}");
    }

    private void FilterByStreetName(ChangeEventArgs evtArgs)
    {
        Console.WriteLine(evtArgs.Value.ToString());
    }
}